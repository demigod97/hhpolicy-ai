# Test Design: Story 1.1 - Project Foundation & Rebranding

Date: 2025-01-18
Designer: Quinn (Test Architect)

## Test Strategy Overview

- **Total test scenarios**: 18
- **Unit tests**: 7 (39%)
- **Integration tests**: 6 (33%)
- **E2E tests**: 5 (28%)
- **Priority distribution**: P0: 6, P1: 8, P2: 4

## Test Scenarios by Acceptance Criteria

### AC1: Application Branding Update

#### Scenarios

| ID           | Level       | Priority | Test                              | Justification                    |
| ------------ | ----------- | -------- | --------------------------------- | -------------------------------- |
| 1.1-UNIT-001 | Unit        | P1       | Verify package.json name = "policyai" | Isolated configuration validation |
| 1.1-UNIT-002 | Unit        | P1       | Verify HTML title contains "PolicyAi"  | Core branding element            |
| 1.1-UNIT-003 | Unit        | P2       | Verify meta description has PolicyAi    | SEO and browser display          |
| 1.1-INT-001  | Integration | P0       | Verify application launches cleanly     | Critical application stability   |
| 1.1-E2E-001  | E2E         | P1       | Verify browser tab shows "PolicyAi"    | End user experience validation   |
| 1.1-E2E-002  | E2E         | P2       | Verify no "InsightsLM" text in UI      | Complete branding transformation |

### AC2: Notebook → Policy Document Terminology

#### Scenarios

| ID           | Level       | Priority | Test                                    | Justification                     |
| ------------ | ----------- | -------- | --------------------------------------- | --------------------------------- |
| 1.1-UNIT-004 | Unit        | P1       | Verify dashboard shows "Policy Documents" | Core terminology consistency      |
| 1.1-UNIT-005 | Unit        | P1       | Verify create button uses "Policy Document" | User action clarity               |
| 1.1-INT-002  | Integration | P0       | Verify database migration completes     | Data integrity critical           |
| 1.1-INT-003  | Integration | P0       | Verify FK constraints work post-rename  | Database relationship integrity   |
| 1.1-INT-004  | Integration | P1       | Verify API responses use new terminology | Service layer consistency         |
| 1.1-E2E-003  | E2E         | P1       | Verify consistent terminology in user flow | End-to-end user experience        |
| 1.1-E2E-004  | E2E         | P2       | Verify error messages use new terms     | Error handling consistency        |

### AC3: Audio/Podcast Feature Removal

#### Scenarios

| ID           | Level       | Priority | Test                                   | Justification                    |
| ------------ | ----------- | -------- | -------------------------------------- | -------------------------------- |
| 1.1-UNIT-006 | Unit        | P0       | Verify no audio components in build    | Code cleanliness critical        |
| 1.1-UNIT-007 | Unit        | P0       | Verify no audio imports cause errors   | Build stability                  |
| 1.1-INT-005  | Integration | P0       | Verify audio DB columns removed        | Database schema integrity        |
| 1.1-INT-006  | Integration | P0       | Verify N8N audio workflows deleted     | Backend workflow cleanup         |
| 1.1-E2E-005  | E2E         | P1       | Verify no audio UI elements visible    | Complete feature removal         |
| 1.1-E2E-006  | E2E         | P2       | Verify no broken audio links           | Navigation integrity             |

## Risk Coverage Analysis

### High-Risk Areas Covered

**TECH-001 (Database Migration Complexity - Score: 6)**:
- ✅ 1.1-INT-002: Migration completion validation
- ✅ 1.1-INT-003: FK constraint verification
- ✅ 1.1-INT-005: Column removal validation
- ✅ 1.1-E2E-003: End-to-end data flow verification

**TECH-002 (Legacy Code References - Score: 6)**:
- ✅ 1.1-UNIT-006: Audio component cleanup
- ✅ 1.1-UNIT-007: Import error detection
- ✅ 1.1-E2E-002: UI text consistency
- ✅ 1.1-E2E-003: Complete terminology flow

**OPS-001 (Deployment Rollback Difficulty - Score: 4)**:
- ✅ 1.1-INT-001: Application launch verification
- ✅ 1.1-INT-002: Migration success validation

## Recommended Execution Order

### Phase 1: Critical Path (P0) - Fail Fast
1. **1.1-UNIT-006**: Verify no audio components in build
2. **1.1-UNIT-007**: Verify no audio import errors
3. **1.1-INT-001**: Verify application launches cleanly
4. **1.1-INT-002**: Verify database migration completes
5. **1.1-INT-003**: Verify FK constraints work post-rename
6. **1.1-INT-005**: Verify audio DB columns removed
7. **1.1-INT-006**: Verify N8N audio workflows deleted

### Phase 2: Core Functionality (P1)
8. **1.1-UNIT-001**: Package.json name validation
9. **1.1-UNIT-002**: HTML title validation
10. **1.1-UNIT-004**: Dashboard terminology
11. **1.1-UNIT-005**: Create button terminology
12. **1.1-INT-004**: API response terminology
13. **1.1-E2E-001**: Browser tab title
14. **1.1-E2E-003**: Complete terminology flow
15. **1.1-E2E-005**: No audio UI elements

### Phase 3: Polish and Edge Cases (P2)
16. **1.1-UNIT-003**: Meta description validation
17. **1.1-E2E-002**: No InsightsLM text in UI
18. **1.1-E2E-004**: Error message terminology
19. **1.1-E2E-006**: No broken audio links

## Test Environment Requirements

### Unit Tests
- **Node.js environment** with Jest/Vitest
- **Mock dependencies** for external services
- **TypeScript compilation** validation

### Integration Tests
- **Test database** (separate from development)
- **Supabase test environment**
- **N8N workflow validation** tools
- **Database migration rollback** capability

### E2E Tests
- **Full application deployment** in test environment
- **Browser automation** (Playwright)
- **Cross-browser testing** (Chrome, Firefox, Safari)
- **Visual regression** baseline images

## Test Data Requirements

### Database Migration Tests
- **Pre-migration snapshot** with existing notebooks data
- **Sample policy documents** for validation
- **FK relationship test data** across all related tables

### Terminology Tests
- **Text content samples** covering all UI components
- **API response examples** with old/new terminology
- **Error scenario data** for message validation

## Quality Gates

### Must Pass Before Merge
- All P0 tests passing
- Database migration successful with rollback tested
- No build errors or import failures
- Application launches successfully

### Must Pass Before Production
- All P0 and P1 tests passing
- Visual regression tests pass
- Cross-browser compatibility verified
- Performance baseline maintained

## Test Coverage Gaps Analysis

✅ **Complete Coverage Achieved**:
- All 3 acceptance criteria have test coverage
- All risk areas addressed with appropriate tests
- Critical paths covered at multiple levels

⚠️ **Areas Requiring Manual Validation**:
- User experience impact of terminology changes
- Accessibility compliance with new branding
- SEO impact of meta tag changes

## Maintenance Considerations

### Test Sustainability
- **Stable selectors**: Use data-testid attributes for E2E tests
- **Modular design**: Reusable test components for branding validation
- **Environment isolation**: Separate test data from production

### Future Regression Prevention
- **Terminology validation**: Automated checks for legacy terms
- **Migration patterns**: Reusable patterns for future schema changes
- **Branding consistency**: Automated brand guideline validation

## Success Criteria Summary

**Test design is complete when**:
- ✅ Every AC has comprehensive test coverage
- ✅ High-risk areas have defense-in-depth testing
- ✅ Test execution can be automated in CI/CD
- ✅ Clear success/failure criteria defined
- ✅ Rollback and recovery procedures tested